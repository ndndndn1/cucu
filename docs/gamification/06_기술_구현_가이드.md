# 06. 기술 구현 가이드

> 웹앱 아키텍처, 콘텐츠 파싱 전략, 데이터 스키마, 파일 구조, 오프라인 대안.

---

## 1. 아키텍처 개요

게임화 시스템은 기존 14개 Markdown 교육 모듈을 **변경하지 않고**, 이를 파싱하여 게임 래퍼와 함께 렌더링하는 **래퍼 아키텍처**를 사용한다.

```
┌──────────────────────────────────────────────────────────┐
│                       프론트엔드 (Next.js)                  │
│  ┌───────────┐  ┌──────────┐  ┌─────────────────────┐   │
│  │ Markdown   │  │ 게임 래퍼  │  │ 대시보드 / 포트폴리오  │   │
│  │ 렌더러     │  │ 컴포넌트  │  │ 컴포넌트             │   │
│  │(remark/   │  │ (6 게임)  │  │ (Chart.js)          │   │
│  │ rehype)   │  │          │  │                     │   │
│  └─────┬─────┘  └────┬─────┘  └──────────┬──────────┘   │
│        │              │                    │              │
│  ┌─────┴──────────────┴────────────────────┴──────────┐  │
│  │                    상태 관리 (Zustand)                 │  │
│  │  - 학습 진행 상태  - 재화 (FC/SC)  - 업적/배지         │  │
│  └──────────────────────┬───────────────────────────┘  │
│                          │                              │
├──────────────────────────┼──────────────────────────────┤
│                    저장소 선택                              │
│  ┌──────────────┐  ┌────┴───────────────────────────┐  │
│  │ LocalStorage  │  │ 백엔드 API (선택)                 │  │
│  │ (싱글유저)    │  │ FastAPI/Express + DB             │  │
│  └──────────────┘  └────────────────────────────────┘  │
└──────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────┐
│                  기존 콘텐츠 (변경 없음)                      │
│  docs/education/*.md (14 파일)                            │
│  → 빌드 타임에 파싱하여 JSON으로 변환 후 번들에 포함            │
└──────────────────────────────────────────────────────────┘
```

---

## 2. 권장 기술 스택

### 2.1 프론트엔드

| 기술 | 용도 |
|------|------|
| **Next.js 14+** | 프레임워크 (SSG 모드 — 정적 배포 가능) |
| **remark / rehype** | Markdown → HTML 파싱 및 렌더링 |
| **remark-gfm** | GitHub Flavored Markdown (테이블, 체크리스트) |
| **rehype-raw** | HTML 태그 (details, summary) 렌더링 |
| **Zustand** | 클라이언트 상태 관리 (경량, 타입 안전) |
| **Chart.js** + react-chartjs-2 | 레이더 차트, GFLOP/s 진행 차트 |
| **Canvas / SVG** | 시뮬레이션 인터랙티브 (드래그앤드롭, 그리드 페인팅) |
| **Tailwind CSS** | 스타일링 |
| **Framer Motion** | 애니메이션 (배지 수여, 승진 연출, 코인 드롭) |

### 2.2 백엔드 (선택 — 멀티유저/리더보드 사용 시)

| 기술 | 용도 |
|------|------|
| **FastAPI** (Python) 또는 **Express** (Node.js) | REST API |
| **SQLite** (소규모) 또는 **PostgreSQL** (확장) | 데이터베이스 |
| **JWT** | 인증 |
| **Redis** (선택) | 리더보드 캐시, 세션 |

### 2.3 배포

| 옵션 | 특징 |
|------|------|
| **싱글유저 (정적 배포)** | Vercel / Netlify / GitHub Pages, LocalStorage만 사용, 백엔드 불필요 |
| **멀티유저 (서버 배포)** | Vercel + 별도 API 서버, DB 필요, 리더보드/코호트 지원 |
| **셀프호스팅 (대학)** | Docker Compose 패키지, 대학 서버에 배포 |

---

## 3. 프로젝트 파일 구조

```
gamification-app/
├── public/
│   └── badges/                    # 배지 이미지 (33개)
│
├── content/
│   └── modules/                   # 빌드 시 docs/education/*.md 복사
│
├── src/
│   ├── app/                       # Next.js App Router
│   │   ├── page.tsx               # 메인 대시보드
│   │   ├── module/[id]/page.tsx   # 모듈 학습 페이지
│   │   ├── portfolio/page.tsx     # 포트폴리오 페이지
│   │   ├── shop/page.tsx          # 상점 페이지
│   │   └── leaderboard/page.tsx   # 리더보드 (옵트인)
│   │
│   ├── components/
│   │   ├── markdown/
│   │   │   ├── MarkdownRenderer.tsx   # remark/rehype 기반 렌더러
│   │   │   └── SectionSplitter.tsx    # H2 기반 9-섹션 분리
│   │   │
│   │   ├── games/
│   │   │   ├── GameA_MemoryChallenge.tsx
│   │   │   ├── GameB_ConceptMatching.tsx
│   │   │   ├── GameC_CodeTracing.tsx
│   │   │   ├── GameD_TeachBack.tsx
│   │   │   ├── GameE_Simulation.tsx
│   │   │   └── GameF_OptimizationChallenge.tsx
│   │   │
│   │   ├── simulations/
│   │   │   ├── Sim01_ThreadMapping.tsx
│   │   │   ├── Sim02_DriverAPISequence.tsx
│   │   │   ├── Sim03_FLOPCalculator.tsx
│   │   │   ├── Sim04_MemoryAccessPattern.tsx
│   │   │   ├── Sim05_CoalescingChecker.tsx
│   │   │   ├── Sim06_BankConflictDetector.tsx
│   │   │   ├── Sim07_OuterProductTracer.tsx
│   │   │   ├── Sim08_PipelineTimeline.tsx
│   │   │   ├── Sim09_AsyncPipelineStateMachine.tsx
│   │   │   └── Sim10_ProfileDataInterpreter.tsx
│   │   │
│   │   ├── bossfight/
│   │   │   ├── Boss01_BankConflictGuardian.tsx
│   │   │   ├── Boss02_LatencyDragon.tsx
│   │   │   └── Boss03_FinalBenchmark.tsx
│   │   │
│   │   ├── dashboard/
│   │   │   ├── RankBadge.tsx
│   │   │   ├── GFLOPsChart.tsx
│   │   │   ├── RadarChart.tsx
│   │   │   ├── MasteryHeatmap.tsx
│   │   │   └── Timeline.tsx
│   │   │
│   │   └── ui/
│   │       ├── CoinDrop.tsx           # FC/SC 획득 애니메이션
│   │       ├── ComboMeter.tsx         # 콤보 배율 표시
│   │       ├── PromotionModal.tsx     # 승진 모달
│   │       └── BadgeUnlock.tsx        # 배지 획득 효과
│   │
│   ├── lib/
│   │   ├── parser/
│   │   │   ├── moduleParser.ts        # Markdown → 섹션 구조 파싱
│   │   │   ├── quizExtractor.ts       # 퀴즈 문항 추출
│   │   │   └── simulationMapper.ts    # 시뮬레이션 사양 매핑
│   │   │
│   │   ├── engine/
│   │   │   ├── rewardEngine.ts        # FC/SC 보상 계산
│   │   │   ├── achievementEngine.ts   # 배지 조건 검사
│   │   │   ├── rankEngine.ts          # 직급 승진 판정
│   │   │   └── comboEngine.ts         # 콤보 배율 관리
│   │   │
│   │   ├── store/
│   │   │   ├── usePlayerStore.ts      # 플레이어 상태 (직급, 재화)
│   │   │   ├── useProgressStore.ts    # 학습 진행 상태
│   │   │   ├── useTimelineStore.ts    # 타임라인 이벤트
│   │   │   └── useShopStore.ts        # 상점 인벤토리
│   │   │
│   │   └── data/
│   │       ├── ranks.ts               # 직급 정의 및 조건
│   │       ├── achievements.ts        # 33개 배지 정의
│   │       ├── shopItems.ts           # 상점 아이템 정의
│   │       └── quizAnswers.ts         # 퀴즈 정답 데이터 (12_부록에서 추출)
│   │
│   └── types/
│       ├── player.ts
│       ├── module.ts
│       ├── quiz.ts
│       ├── achievement.ts
│       └── economy.ts
│
├── scripts/
│   └── parseModules.ts            # 빌드 시 Markdown 파싱 스크립트
│
├── package.json
├── tsconfig.json
└── next.config.js
```

---

## 4. 콘텐츠 파싱 전략

### 4.1 H2 헤더로 9-섹션 분리

모든 교육 모듈(04-10)은 `## N.` 패턴의 H2 헤더로 9개 섹션을 구분한다.

```typescript
// moduleParser.ts — 핵심 로직
interface Section {
  number: number;        // 1-9
  title: string;         // H2 헤더 텍스트
  content: string;       // 해당 섹션의 Markdown 원문
  type: SectionType;     // 게임 래퍼 유형 결정
}

function splitSections(markdown: string): Section[] {
  // 정규식: ## 숫자. 제목
  const h2Pattern = /^## (\d+)\.\s+(.+)$/gm;

  // H2 위치 기반으로 콘텐츠 분리
  // 각 H2 사이의 텍스트가 해당 섹션의 콘텐츠
}
```

**섹션 8 변형 인식**:
```typescript
function detectQuizType(sectionTitle: string): 'quiz' | 'mastery' | 'final_mastery' {
  if (sectionTitle.includes('최종 마스터리'))  return 'final_mastery';
  if (sectionTitle.includes('마스터리'))       return 'mastery';
  return 'quiz';
}
```

### 4.2 퀴즈 문항 추출

퀴즈 섹션(섹션 8)에서 개별 문항을 추출한다.

**패턴 인식**:
```typescript
// 문항 시작: ### 문제 N 또는 ### QN
const questionPattern = /^###\s+(문제|Q)\s*(\d+)/gm;

// 보기: (A)~(D) 또는 1.~4.
const optionPattern = /^\([A-D]\)\s+(.+)$/gm;

// 정답 (details 태그 내부)
// <details>
//   <summary>정답</summary>
//   ...정답 내용...
// </details>
const answerPattern = /<details>\s*<summary>.*?정답.*?<\/summary>([\s\S]*?)<\/details>/g;
```

### 4.3 "왜 작동하는가" 질문 추출

섹션 5에서 질문을 추출한다.

```typescript
// 패턴: > **Q숫자** 또는 > **질문 숫자** 또는 번호 목록의 질문
const whyQuestionPattern = />\s*\*\*(Q\d+|질문\s*\d+)[.:]*\*\*\s*(.+)/g;

// 또는 H3 하위의 번호 목록
// ### 심화 질문
// 1. 왜 ...인가?
```

### 4.4 시뮬레이션 사양 매핑

`13_부록_시뮬레이션_가이드.md`의 시뮬레이션 사양을 모듈별로 매핑한다.

```typescript
// 모듈 번호 → 시뮬레이션 번호 매핑
const simulationMap: Record<number, number> = {
  1: 1,   // 모듈 01 → 시뮬레이션 1
  2: 2,   // 모듈 02 → 시뮬레이션 2
  3: 3,   // 모듈 03 → 시뮬레이션 3
  4: 4,   // 모듈 04 → 시뮬레이션 4
  5: 5,   // 모듈 05 → 시뮬레이션 5
  6: 6,   // 모듈 06 → 시뮬레이션 6
  7: 7,   // 모듈 07 → 시뮬레이션 7
  8: 8,   // 모듈 08 → 시뮬레이션 8
  9: 9,   // 모듈 09 → 시뮬레이션 9
  10: 10, // 모듈 10 → 시뮬레이션 10
};
```

---

## 5. 데이터 스키마

### 5.1 플레이어 상태

```typescript
interface PlayerState {
  id: string;
  name: string;
  rank: RankId;                          // 'intern' | 'junior' | ... | 'chip_architect'
  fc: number;                            // FLOP 코인 잔액
  sc: number;                            // 실리콘 크리스탈 잔액
  fcTotalEarned: number;
  scTotalEarned: number;
  currentStreak: number;                 // 연속 접속 일수
  longestStreak: number;
  lastActiveDate: string;                // ISO 8601
  freezeTokens: number;
  createdAt: string;
}
```

### 5.2 모듈 진행 상태

```typescript
interface ModuleProgress {
  moduleId: string;                      // '00' ~ '13'
  status: 'locked' | 'available' | 'in_progress' | 'completed';
  sectionsCompleted: number[];           // 완료된 섹션 번호 [1, 2, 3, ...]
  startedAt: string | null;
  completedAt: string | null;
  timeSpentMinutes: number;
}
```

### 5.3 퀴즈 결과

```typescript
interface QuizResult {
  moduleId: string;
  attemptNumber: number;                 // 시도 횟수
  questions: QuizQuestionResult[];
  totalScore: number;                    // 정답 수
  totalQuestions: number;
  accuracy: number;                      // 0.0 ~ 1.0
  maxCombo: number;
  fcEarned: number;
  bloomDistribution: Record<BloomLevel, { correct: number; total: number }>;
  completedAt: string;
}

interface QuizQuestionResult {
  questionId: string;
  bloomLevel: BloomLevel;
  attempts: number;                      // 이 문항 시도 횟수
  correct: boolean;
  timeSeconds: number;
}

type BloomLevel = 'remember' | 'understand' | 'apply' | 'analyze' | 'evaluate' | 'create';
```

### 5.4 시뮬레이션 결과

```typescript
interface SimulationResult {
  simulationId: number;                  // 1-10
  moduleId: string;
  accuracy: number;                      // 0.0 ~ 1.0
  fcEarned: number;
  timeSpentMinutes: number;
  completedAt: string;
  details: Record<string, unknown>;      // 시뮬레이션별 상세 데이터
}
```

### 5.5 업적

```typescript
interface Achievement {
  id: string;
  name: string;
  nameEn: string;
  description: string;
  tier: 1 | 2 | 3 | 4;
  icon: string;                          // 이미지 경로
  condition: AchievementCondition;       // 조건 검사 함수 ID
  scReward: number;
  earnedAt: string | null;
}
```

### 5.6 타임라인 이벤트

```typescript
interface TimelineEvent {
  id: string;
  type: EventType;
  timestamp: string;                     // ISO 8601
  data: Record<string, unknown>;         // 이벤트 유형별 상세 데이터
  moduleId?: string;
}

type EventType =
  | 'module_start'
  | 'section_complete'
  | 'quiz_submit'
  | 'simulation_complete'
  | 'boss_attempt'
  | 'rank_promotion'
  | 'achievement_earned'
  | 'currency_change'
  | 'shop_purchase'
  | 'streak_update'
  | 'module_complete';
```

### 5.7 상점 인벤토리

```typescript
interface ShopItem {
  id: string;
  name: string;
  description: string;
  currency: 'fc' | 'sc';
  price: number;
  category: 'convenience' | 'cosmetic' | 'premium';
  maxPurchases: number | null;           // null = 무제한
  purchaseScope?: 'global' | 'per_module';
}

interface PlayerInventory {
  items: {
    itemId: string;
    quantity: number;
    purchasedAt: string[];
  }[];
}
```

---

## 6. 핵심 엔진 로직

### 6.1 보상 엔진

```typescript
// rewardEngine.ts
function calculateQuizReward(result: QuizQuestionResult, comboMultiplier: number): number {
  if (!result.correct) return 0;
  const baseFC = result.attempts === 1 ? 20 : result.attempts === 2 ? 10 : 5;
  return Math.floor(baseFC * comboMultiplier);
}

function calculateSimulationReward(accuracy: number): number {
  if (accuracy >= 0.95) return 150;
  if (accuracy >= 0.80) return 100;
  return 50;
}

function calculateStreakBonus(streakDay: number): number {
  return Math.min(streakDay * 10, 100);
}
```

### 6.2 콤보 엔진

```typescript
// comboEngine.ts
function getComboMultiplier(consecutiveCorrect: number): number {
  if (consecutiveCorrect >= 7) return 3.0;
  if (consecutiveCorrect >= 5) return 2.0;
  if (consecutiveCorrect >= 3) return 1.5;
  return 1.0;
}
```

### 6.3 직급 엔진

```typescript
// rankEngine.ts
interface RankRequirement {
  id: RankId;
  name: string;
  nameEn: string;
  requiredModules: string[];             // 완료 필수 모듈 ID
  requiredMastery?: string;              // 통과 필수 마스터리 체크포인트 모듈 ID
  baseGflops: number;
}

const RANKS: RankRequirement[] = [
  { id: 'intern',        name: '수습 엔지니어',       nameEn: 'Intern Engineer',        requiredModules: [],                         baseGflops: 0 },
  { id: 'junior',        name: '주니어 엔지니어',     nameEn: 'Junior Engineer',        requiredModules: ['00','01','02','03'],       baseGflops: 50 },
  { id: 'engineer',      name: '엔지니어',           nameEn: 'Engineer',               requiredModules: ['04'],                      baseGflops: 200 },
  { id: 'senior',        name: '시니어 엔지니어',     nameEn: 'Senior Engineer',        requiredModules: ['05'], requiredMastery: '06', baseGflops: 800 },
  { id: 'staff',         name: '스태프 엔지니어',     nameEn: 'Staff Engineer',         requiredModules: ['06'],                      baseGflops: 2000 },
  { id: 'principal',     name: '프린시펄 엔지니어',   nameEn: 'Principal Engineer',     requiredModules: ['07'], requiredMastery: '08', baseGflops: 4000 },
  { id: 'distinguished', name: '디스팅귀시드 엔지니어', nameEn: 'Distinguished Engineer', requiredModules: ['08'], requiredMastery: '09', baseGflops: 7000 },
  { id: 'chip_architect', name: '칩 아키텍트',       nameEn: 'Chip Architect',         requiredModules: ['09','10'],                 baseGflops: 9500 },
];

function calculatePersonalGflops(rank: RankRequirement, quizAccuracy: number): number {
  const masteryMultiplier = 0.5 + (quizAccuracy * 0.5);
  return Math.floor(rank.baseGflops * masteryMultiplier);
}
```

### 6.4 업적 검사 엔진

```typescript
// achievementEngine.ts — 조건 검사 함수 패턴
type AchievementChecker = (state: GameState) => boolean;

const achievementCheckers: Record<string, AchievementChecker> = {
  'perfect_recall': (s) => {
    // 사전 복습 퀴즈 5개 연속 만점
    return s.reviewQuizPerfectStreak >= 5;
  },
  'speed_demon': (s) => {
    // 사전 복습 퀴즈 3개 연속 30초 이내 만점
    return s.reviewQuizSpeedStreak >= 3;
  },
  'combo_king': (s) => {
    // 퀴즈에서 10연속 정답 콤보
    return s.maxComboEver >= 10;
  },
  // ... 33개 배지 각각에 대해 정의
};
```

---

## 7. LocalStorage 스키마 (싱글유저 모드)

싱글유저 모드에서는 모든 데이터를 브라우저의 LocalStorage에 저장한다.

```typescript
// 저장 키 구조
const STORAGE_KEYS = {
  PLAYER:     'baremetal_sgemm_player',      // PlayerState
  PROGRESS:   'baremetal_sgemm_progress',    // Record<moduleId, ModuleProgress>
  QUIZZES:    'baremetal_sgemm_quizzes',     // QuizResult[]
  SIMS:       'baremetal_sgemm_simulations', // SimulationResult[]
  TIMELINE:   'baremetal_sgemm_timeline',    // TimelineEvent[]
  INVENTORY:  'baremetal_sgemm_inventory',   // PlayerInventory
  ACHIEVEMENTS: 'baremetal_sgemm_achievements', // Achievement[]
  SETTINGS:   'baremetal_sgemm_settings',    // UserSettings
};

// 저장/불러오기 유틸리티
function saveState<T>(key: string, data: T): void {
  localStorage.setItem(key, JSON.stringify(data));
}

function loadState<T>(key: string, defaultValue: T): T {
  const raw = localStorage.getItem(key);
  return raw ? JSON.parse(raw) : defaultValue;
}
```

**데이터 크기 추정**:
- 플레이어 상태: ~0.5 KB
- 모듈 진행 (14개): ~3 KB
- 퀴즈 결과 (75문항 × 여러 시도): ~20 KB
- 시뮬레이션 결과 (10개): ~5 KB
- 타임라인 (200개 이벤트): ~30 KB
- 업적 (33개): ~5 KB
- **총합: ~65 KB** (LocalStorage 5MB 한도의 1.3%)

---

## 8. DB 스키마 (멀티유저 모드)

멀티유저 모드에서는 SQLite 또는 PostgreSQL을 사용한다.

```sql
-- 플레이어
CREATE TABLE players (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    rank_id TEXT NOT NULL DEFAULT 'intern',
    fc INTEGER NOT NULL DEFAULT 0,
    sc INTEGER NOT NULL DEFAULT 0,
    fc_total_earned INTEGER NOT NULL DEFAULT 0,
    sc_total_earned INTEGER NOT NULL DEFAULT 0,
    current_streak INTEGER NOT NULL DEFAULT 0,
    longest_streak INTEGER NOT NULL DEFAULT 0,
    freeze_tokens INTEGER NOT NULL DEFAULT 0,
    last_active_date TEXT,
    created_at TEXT NOT NULL DEFAULT (datetime('now')),
    -- 리더보드 옵트인
    leaderboard_opted_in BOOLEAN NOT NULL DEFAULT FALSE,
    leaderboard_nickname TEXT
);

-- 모듈 진행
CREATE TABLE module_progress (
    player_id TEXT REFERENCES players(id),
    module_id TEXT NOT NULL,
    status TEXT NOT NULL DEFAULT 'locked',
    sections_completed TEXT DEFAULT '[]',  -- JSON array
    time_spent_minutes INTEGER DEFAULT 0,
    started_at TEXT,
    completed_at TEXT,
    PRIMARY KEY (player_id, module_id)
);

-- 퀴즈 결과
CREATE TABLE quiz_results (
    id TEXT PRIMARY KEY,
    player_id TEXT REFERENCES players(id),
    module_id TEXT NOT NULL,
    attempt_number INTEGER NOT NULL,
    accuracy REAL NOT NULL,
    max_combo INTEGER NOT NULL DEFAULT 0,
    fc_earned INTEGER NOT NULL DEFAULT 0,
    bloom_distribution TEXT NOT NULL,  -- JSON
    completed_at TEXT NOT NULL
);

-- 퀴즈 문항 결과
CREATE TABLE quiz_question_results (
    quiz_result_id TEXT REFERENCES quiz_results(id),
    question_id TEXT NOT NULL,
    bloom_level TEXT NOT NULL,
    attempts INTEGER NOT NULL DEFAULT 1,
    correct BOOLEAN NOT NULL,
    time_seconds REAL,
    PRIMARY KEY (quiz_result_id, question_id)
);

-- 시뮬레이션 결과
CREATE TABLE simulation_results (
    id TEXT PRIMARY KEY,
    player_id TEXT REFERENCES players(id),
    simulation_id INTEGER NOT NULL,
    module_id TEXT NOT NULL,
    accuracy REAL NOT NULL,
    fc_earned INTEGER NOT NULL DEFAULT 0,
    time_spent_minutes INTEGER DEFAULT 0,
    details TEXT,  -- JSON
    completed_at TEXT NOT NULL
);

-- 업적
CREATE TABLE player_achievements (
    player_id TEXT REFERENCES players(id),
    achievement_id TEXT NOT NULL,
    earned_at TEXT NOT NULL,
    PRIMARY KEY (player_id, achievement_id)
);

-- 타임라인
CREATE TABLE timeline_events (
    id TEXT PRIMARY KEY,
    player_id TEXT REFERENCES players(id),
    event_type TEXT NOT NULL,
    module_id TEXT,
    data TEXT NOT NULL,  -- JSON
    created_at TEXT NOT NULL DEFAULT (datetime('now'))
);

-- 인벤토리
CREATE TABLE player_inventory (
    player_id TEXT REFERENCES players(id),
    item_id TEXT NOT NULL,
    quantity INTEGER NOT NULL DEFAULT 0,
    PRIMARY KEY (player_id, item_id)
);

-- 코호트 (대학 수업용)
CREATE TABLE cohorts (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    invite_code TEXT UNIQUE NOT NULL,
    instructor_id TEXT REFERENCES players(id),
    created_at TEXT NOT NULL DEFAULT (datetime('now'))
);

CREATE TABLE cohort_members (
    cohort_id TEXT REFERENCES cohorts(id),
    player_id TEXT REFERENCES players(id),
    joined_at TEXT NOT NULL DEFAULT (datetime('now')),
    PRIMARY KEY (cohort_id, player_id)
);

-- 인덱스
CREATE INDEX idx_timeline_player_date ON timeline_events(player_id, created_at DESC);
CREATE INDEX idx_quiz_results_player ON quiz_results(player_id, module_id);
CREATE INDEX idx_module_progress_player ON module_progress(player_id);
```

---

## 9. 오프라인 대안

인터넷이나 컴퓨터를 사용할 수 없는 환경을 위한 아날로그 대안.

### 9.1 종이 스코어카드

| 항목 | 형태 |
|------|------|
| 직급 추적 | 체크리스트 (8단계) |
| FC 잔액 | 수기 기입 (획득/소비/잔액 열) |
| 퀴즈 결과 | 모듈별 정답률 기입 |
| 시뮬레이션 | 완료 체크 + 정확도 메모 |
| 연속 접속 | 날짜 스탬프 |

### 9.2 배지 스티커 시트

33개 배지를 인쇄한 스티커 시트. 획득 조건 충족 시 스코어카드에 부착.

### 9.3 포트폴리오 바인더

모듈별 학습 기록을 바인더에 정리:
- 모듈 커버 시트 (학습 목표 체크리스트)
- 퀴즈 답안지
- 시뮬레이션 작업 용지
- 자기 평가 기록

### 9.4 QR코드 답 검증

각 퀴즈의 정답을 QR코드로 인코딩. 스마트폰으로 스캔하면 정답과 해설 표시. 기존 `12_부록_퀴즈_정답.md`의 내용을 QR코드로 변환.

---

## 10. 구현 우선순위

단계별 구현을 권장한다.

| 단계 | 구현 범위 | 예상 복잡도 |
|------|---------|-----------|
| **Phase 1: MVP** | Markdown 렌더링 + 퀴즈 게임 F + 직급 시스템 + LocalStorage | 중간 |
| **Phase 2: 시뮬레이션** | 10개 인터랙티브 시뮬레이션 + 게임 E | 높음 |
| **Phase 3: 게임 A-D** | 기억력 챌린지, 개념 매칭, 코드 추적, 티치백 | 중간 |
| **Phase 4: 경제** | FC/SC 시스템 + 상점 + 재화 흐름 | 낮음 |
| **Phase 5: 포트폴리오** | 타임라인, 레이더 차트, 히트맵, PDF/JSON 내보내기 | 중간 |
| **Phase 6: 소셜** | 백엔드 + 리더보드 + 코호트 | 높음 |
| **Phase 7: 보스전** | 3개 보스전 + 보스전 UI | 중간 |
